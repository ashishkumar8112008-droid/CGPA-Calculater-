<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>University Grade Calculator & Target Setter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        .input-cell {
            background: #fff;
            border: 1px solid #e5e7eb;
            padding: 4px;
            width: 100%;
            border-radius: 4px;
            text-align: center;
        }

        .input-cell:focus {
            outline: 2px solid #3b82f6;
            border-color: transparent;
        }

        td,
        th {
            white-space: nowrap;
        }
    </style>
</head>

<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
            <div>
                <h1 class="text-2xl font-bold text-gray-800">Academic Performance Dashboard</h1>
                <p class="text-lg font-semibold text-orange-600 mt-1">For LPU Students</p>
                <p class="text-sm text-gray-500 mt-1">Edit values directly. Auto-calculates CA(25%) + Mid(20%) + Att(5%)
                    + End(50%)</p>
            </div>
            <div class="flex flex-col md:flex-row items-center gap-3">
                <a href="https://www.linkedin.com/in/ashish-kumar-859842250" target="_blank" rel="noopener noreferrer"
                    class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-4 py-2 rounded-lg shadow-md hover:shadow-lg hover:scale-105 transition-all cursor-pointer">
                    <p class="text-xs font-medium opacity-90">Made by</p>
                    <p class="text-sm font-bold">Ashish Kumar</p>
                </a>
                <button onclick="downloadCSV()"
                    class="bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded shadow flex items-center gap-2 transition-all">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd"
                            d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z"
                            clip-rule="evenodd" />
                    </svg>
                    Download Excel
                </button>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-lg overflow-x-auto border border-gray-200">
            <table class="w-full text-sm text-left text-gray-700" id="gradeTable">
                <thead class="text-xs text-gray-700 uppercase bg-gray-50 border-b">
                    <tr>
                        <th class="px-4 py-3 sticky left-0 bg-gray-50 shadow-r">Subject</th>
                        <th class="px-2 py-3 text-center bg-blue-50">CA 1<br><span
                                class="text-[10px] text-gray-400">/30</span></th>
                        <th class="px-2 py-3 text-center bg-blue-50">CA 2<br><span
                                class="text-[10px] text-gray-400">/30</span></th>
                        <th class="px-2 py-3 text-center bg-blue-100 font-bold border-r">CA Wtg<br><span
                                class="text-[10px]">25%</span></th>

                        <th class="px-2 py-3 text-center bg-orange-50">Mid Term<br><span
                                class="text-[10px] text-gray-400">Obt Marks</span></th>
                        <th class="px-2 py-3 text-center bg-orange-50">Max<br><span
                                class="text-[10px] text-gray-400">Total</span></th>
                        <th class="px-2 py-3 text-center bg-orange-100 font-bold border-r">Mid Wtg<br><span
                                class="text-[10px]">20%</span></th>

                        <th class="px-2 py-3 text-center bg-green-50">Att.<br><span class="text-[10px]">5%</span></th>

                        <th class="px-4 py-3 text-center bg-gray-100 font-black border-r border-l">Pre-Final<br><span
                                class="text-[10px]">Out of 50</span></th>

                        <th class="px-2 py-3 text-center text-red-600 bg-red-50 border-r">TARGET:<br>Pass (45%)</th>
                        <th class="px-2 py-3 text-center text-indigo-600 bg-indigo-50 border-r">TARGET:<br>7 CGPA (70%)
                        </th>
                        <th class="px-2 py-3 text-center text-purple-600 bg-purple-50 border-r">TARGET:<br>8 CGPA (80%)
                        </th>
                        <th class="px-2 py-3 text-center text-green-600 bg-green-50">TARGET:<br>9 CGPA (90%)</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Rows will be injected by JS -->
                </tbody>
            </table>
        </div>

        <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg">
                <h3 class="font-bold text-blue-800 mb-2">How Calculated?</h3>
                <ul class="list-disc list-inside text-sm text-blue-700 space-y-1">
                    <li><strong>CA (25%):</strong> Average of CA1 & CA2, scaled to 25%.</li>
                    <li><strong>Mid Term (20%):</strong> (Marks Obtained / Max Marks) √ó 20.</li>
                    <li><strong>Attendance (5%):</strong> Assumed full 5 points (Edit if lower).</li>
                    <li><strong>Finals (50%):</strong> The exam is out of 60 marks.</li>
                </ul>
            </div>
            <div class="bg-red-50 border border-red-200 p-4 rounded-lg">
                <h3 class="font-bold text-red-800 mb-2">Alert Legend</h3>
                <div class="flex gap-4 text-sm">
                    <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-red-500"></span> Fail
                        Risk</span>
                    <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-yellow-400"></span>
                        Borderline</span>
                    <span class="flex items-center gap-1"><span class="w-3 h-3 rounded-full bg-green-500"></span>
                        Safe</span>
                </div>
            </div>
        </div>

        <!-- Detailed Calculation Breakdown -->
        <div class="mt-6 bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-300 p-6 rounded-xl shadow-md">
            <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-slate-600" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
                </svg>
                Detailed Calculation Breakdown
            </h2>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Left Column: Component Calculations -->
                <div class="bg-white p-5 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="font-bold text-slate-700 mb-3 text-lg border-b pb-2">üìä Component Calculations</h3>

                    <div class="space-y-4">
                        <div class="bg-blue-50 p-3 rounded-md border-l-4 border-blue-500">
                            <h4 class="font-semibold text-blue-800 mb-2">1Ô∏è‚É£ CA Weightage (25%)</h4>
                            <div class="text-sm text-blue-700 space-y-1 font-mono">
                                <p><strong>Formula:</strong> ((CA1 + CA2) / 60) √ó 25</p>
                                <p class="text-xs text-blue-600">Example: ((20 + 25) / 60) √ó 25 = 18.75</p>
                            </div>
                        </div>

                        <div class="bg-orange-50 p-3 rounded-md border-l-4 border-orange-500">
                            <h4 class="font-semibold text-orange-800 mb-2">2Ô∏è‚É£ Mid Term Weightage (20%)</h4>
                            <div class="text-sm text-orange-700 space-y-1 font-mono">
                                <p><strong>Formula:</strong> (Obtained / Max) √ó 20</p>
                                <p class="text-xs text-orange-600">Example: (25 / 30) √ó 20 = 16.67</p>
                            </div>
                        </div>

                        <div class="bg-green-50 p-3 rounded-md border-l-4 border-green-500">
                            <h4 class="font-semibold text-green-800 mb-2">3Ô∏è‚É£ Attendance (5%)</h4>
                            <div class="text-sm text-green-700 space-y-1 font-mono">
                                <p><strong>Value:</strong> Direct input (max 5)</p>
                                <p class="text-xs text-green-600">Example: 5 (full attendance)</p>
                            </div>
                        </div>

                        <div class="bg-gray-50 p-3 rounded-md border-l-4 border-gray-500">
                            <h4 class="font-semibold text-gray-800 mb-2">4Ô∏è‚É£ Pre-Final Total (50%)</h4>
                            <div class="text-sm text-gray-700 space-y-1 font-mono">
                                <p><strong>Formula:</strong> CA + Mid + Attendance</p>
                                <p class="text-xs text-gray-600">Example: 18.75 + 16.67 + 5 = 40.42</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Target Calculations -->
                <div class="bg-white p-5 rounded-lg shadow-sm border border-slate-200">
                    <h3 class="font-bold text-slate-700 mb-3 text-lg border-b pb-2">üéØ Target Calculations</h3>

                    <div class="space-y-4">
                        <div class="bg-red-50 p-3 rounded-md border-l-4 border-red-500">
                            <h4 class="font-semibold text-red-800 mb-2">Pass (45%)</h4>
                            <div class="text-sm text-red-700 space-y-1 font-mono">
                                <p><strong>Step 1:</strong> Required = 45 - Pre-Final</p>
                                <p><strong>Step 2:</strong> Final Marks = (Required / 50) √ó 60</p>
                                <p class="text-xs text-red-600 bg-red-100 p-2 rounded mt-2">
                                    Example: Pre-Final = 40.42<br>
                                    Required = 45 - 40.42 = 4.58<br>
                                    Final = (4.58 / 50) √ó 60 = 5.5 ‚âà 6/60
                                </p>
                            </div>
                        </div>

                        <div class="bg-indigo-50 p-3 rounded-md border-l-4 border-indigo-500">
                            <h4 class="font-semibold text-indigo-800 mb-2">7 CGPA (70%)</h4>
                            <div class="text-sm text-indigo-700 space-y-1 font-mono">
                                <p><strong>Step 1:</strong> Required = 70 - Pre-Final</p>
                                <p><strong>Step 2:</strong> Final Marks = (Required / 50) √ó 60</p>
                                <p class="text-xs text-indigo-600 bg-indigo-100 p-2 rounded mt-2">
                                    Example: Pre-Final = 40.42<br>
                                    Required = 70 - 40.42 = 29.58<br>
                                    Final = (29.58 / 50) √ó 60 = 35.5 ‚âà 36/60
                                </p>
                            </div>
                        </div>

                        <div class="bg-purple-50 p-3 rounded-md border-l-4 border-purple-500">
                            <h4 class="font-semibold text-purple-800 mb-2">8 CGPA (80%)</h4>
                            <div class="text-sm text-purple-700 space-y-1 font-mono">
                                <p><strong>Step 1:</strong> Required = 80 - Pre-Final</p>
                                <p><strong>Step 2:</strong> Final Marks = (Required / 50) √ó 60</p>
                                <p class="text-xs text-purple-600 bg-purple-100 p-2 rounded mt-2">
                                    Example: Pre-Final = 40.42<br>
                                    Required = 80 - 40.42 = 39.58<br>
                                    Final = (39.58 / 50) √ó 60 = 47.5 ‚âà 48/60
                                </p>
                            </div>
                        </div>

                        <div class="bg-green-50 p-3 rounded-md border-l-4 border-green-500">
                            <h4 class="font-semibold text-green-800 mb-2">9 CGPA (90%)</h4>
                            <div class="text-sm text-green-700 space-y-1 font-mono">
                                <p><strong>Step 1:</strong> Required = 90 - Pre-Final</p>
                                <p><strong>Step 2:</strong> Final Marks = (Required / 50) √ó 60</p>
                                <p class="text-xs text-green-600 bg-green-100 p-2 rounded mt-2">
                                    Example: Pre-Final = 40.42<br>
                                    Required = 90 - 40.42 = 49.58<br>
                                    Final = (49.58 / 50) √ó 60 = 59.5 ‚âà 60/60
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-4 bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                <p class="text-sm text-yellow-800">
                    <strong>üí° Note:</strong> Final exam is worth 50% of total marks and is out of 60 marks.
                    If target shows "IMPOSSIBLE", you need more than 60/60 in finals, which means you should focus on
                    improving other components.
                </p>
            </div>
        </div>
    </div>

    <script>
        // Initial Data - Empty template for user input
        const initialData = [
            { name: "MEC136: Eng Drawing", ca1: 0, ca2: 0, mtObt: 0, mtMax: 30, att: 5 },
            { name: "MTH165: Mathematics", ca1: 0, ca2: 0, mtObt: 0, mtMax: 30, att: 5 },
            { name: "PHY110: Physics", ca1: 0, ca2: 0, mtObt: 0, mtMax: 30, att: 5 },
            { name: "INT108: Python Prog", ca1: 0, ca2: 0, mtObt: 0, mtMax: 30, att: 5 },
            { name: "CSE111: Orientation", ca1: 0, ca2: 0, mtObt: 0, mtMax: 30, att: 5 },
            { name: "CSE326: Internet Prog", ca1: 0, ca2: 0, mtObt: 0, mtMax: 30, att: 5 }
        ];

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            initialData.forEach((row, index) => {
                const caTotal = (parseFloat(row.ca1) || 0) + (parseFloat(row.ca2) || 0);
                const caWtg = (caTotal / 60) * 25;
                const mtWtg = row.mtMax > 0 ? ((parseFloat(row.mtObt) || 0) / parseFloat(row.mtMax)) * 20 : 0;
                const attWtg = parseFloat(row.att) || 0;
                const preFinal = caWtg + mtWtg + attWtg;

                let needForPassWtg = 45 - preFinal;
                let needForPassRaw = needForPassWtg > 0 ? (needForPassWtg / 50) * 60 : 0;
                let needFor7Wtg = 70 - preFinal;
                let needFor7Raw = needFor7Wtg > 0 ? (needFor7Wtg / 50) * 60 : 0;
                let needFor8Wtg = 80 - preFinal;
                let needFor8Raw = needFor8Wtg > 0 ? (needFor8Wtg / 50) * 60 : 0;
                let needFor9Wtg = 90 - preFinal;
                let needFor9Raw = needFor9Wtg > 0 ? (needFor9Wtg / 50) * 60 : 0;

                const passText = needForPassRaw <= 0 ? "PASSED" : needForPassRaw > 60 ? "IMPOSSIBLE" : Math.ceil(needForPassRaw);
                const sevenText = needFor7Raw <= 0 ? "SECURED" : needFor7Raw > 60 ? "IMPOSSIBLE" : Math.ceil(needFor7Raw);
                const eightText = needFor8Raw <= 0 ? "SECURED" : needFor8Raw > 60 ? "IMPOSSIBLE" : Math.ceil(needFor8Raw);
                const nineText = needFor9Raw <= 0 ? "SECURED" : needFor9Raw > 60 ? "IMPOSSIBLE" : Math.ceil(needFor9Raw);

                const passClass = needForPassRaw > 60 ? 'bg-red-200 text-red-900 font-bold' : (needForPassRaw > 30 ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700');
                const rowClass = index % 2 === 0 ? 'bg-white' : 'bg-gray-50';

                const tr = document.createElement('tr');
                tr.className = `border-b hover:bg-gray-50 ${rowClass}`;
                tr.innerHTML = `
                <td class="px-4 py-3 font-medium text-gray-900 sticky left-0 ${rowClass} shadow-r">${row.name}</td>
                <td class="px-2 py-3"><input type="number" value="${row.ca1}" onchange="updateData(${index}, 'ca1', this.value)" class="input-cell text-gray-600"></td>
                <td class="px-2 py-3"><input type="number" value="${row.ca2}" onchange="updateData(${index}, 'ca2', this.value)" class="input-cell text-gray-600"></td>
                <td class="px-2 py-3 text-center font-bold text-blue-600 border-r bg-blue-50/50">${caWtg.toFixed(1)}</td>
                
                <td class="px-2 py-3"><input type="number" value="${row.mtObt}" onchange="updateData(${index}, 'mtObt', this.value)" class="input-cell text-gray-600"></td>
                <td class="px-2 py-3"><input type="number" value="${row.mtMax}" onchange="updateData(${index}, 'mtMax', this.value)" class="input-cell text-gray-400 text-xs"></td>
                <td class="px-2 py-3 text-center font-bold text-orange-600 border-r bg-orange-50/50">${mtWtg.toFixed(1)}</td>
                
                <td class="px-2 py-3"><input type="number" value="${row.att}" max="5" onchange="updateData(${index}, 'att', this.value)" class="input-cell text-gray-600"></td>
                
                <td class="px-4 py-3 text-center font-black text-gray-800 bg-gray-100 border-r border-l text-lg">${preFinal.toFixed(1)}</td>
                
                <td class="px-2 py-3 text-center border-r font-bold ${passClass}">${passText}${typeof passText === 'number' ? '<span class="text-xs font-normal text-gray-500">/60</span>' : ''}</td>
                <td class="px-2 py-3 text-center border-r font-bold text-indigo-700">${sevenText}${typeof sevenText === 'number' ? '<span class="text-xs font-normal text-gray-400">/60</span>' : ''}</td>
                <td class="px-2 py-3 text-center border-r font-bold text-purple-700">${eightText}${typeof eightText === 'number' ? '<span class="text-xs font-normal text-gray-400">/60</span>' : ''}</td>
                <td class="px-2 py-3 text-center font-bold text-green-700">${nineText}${typeof nineText === 'number' ? '<span class="text-xs font-normal text-gray-400">/60</span>' : ''}</td>
            `;
                tbody.appendChild(tr);
            });
        }

        function updateData(index, field, value) {
            initialData[index][field] = parseFloat(value) || 0;
            renderTable();
        }

        function downloadCSV() {
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Subject,CA1,CA2,CA Wtg (25%),MidTerm,MidTerm Max,MidTerm Wtg (20%),Attendance (5%),Pre-Final (50%),Pass (45%),7 CGPA (70%),8 CGPA (80%),9 CGPA (90%)\n";

            initialData.forEach(row => {
                const caTotal = (row.ca1 || 0) + (row.ca2 || 0);
                const caWtg = (caTotal / 60) * 25;
                const mtWtg = row.mtMax > 0 ? ((row.mtObt || 0) / row.mtMax) * 20 : 0;
                const preFinal = caWtg + mtWtg + (row.att || 0);

                let needForPass = (45 - preFinal) > 0 ? ((45 - preFinal) / 50) * 60 : 0;
                let needFor7 = (70 - preFinal) > 0 ? ((70 - preFinal) / 50) * 60 : 0;
                let needFor8 = (80 - preFinal) > 0 ? ((80 - preFinal) / 50) * 60 : 0;
                let needFor9 = (90 - preFinal) > 0 ? ((90 - preFinal) / 50) * 60 : 0;

                const rowString = [
                    row.name, row.ca1, row.ca2, caWtg.toFixed(2),
                    row.mtObt, row.mtMax, mtWtg.toFixed(2), row.att,
                    preFinal.toFixed(2),
                    Math.ceil(needForPass),
                    Math.ceil(needFor7),
                    Math.ceil(needFor8),
                    Math.ceil(needFor9)
                ].join(",");
                csvContent += rowString + "\n";
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "lpu_grades_calculator.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Initialize
        renderTable();
    </script>

</body>

</html>